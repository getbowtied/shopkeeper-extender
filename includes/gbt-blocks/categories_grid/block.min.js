"use strict";!function(e,t,r,i,s){var u=s.createElement,a=e.registerBlockType,n=wp.components,c=n.TextControl,p=n.SelectControl,d=(n.RadioControl,n.ToggleControl),l=n.SVG,o=n.Path,y=wp.blockEditor.InspectorControls,g=wp.editor.ServerSideRender,h=wp.apiFetch;a("getbowtied/sk-categories-grid",{title:i.__("Product Categories - Grid","shopkeeper-extender"),icon:u(l,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},u(o,{d:"M19 5v2h-4V5h4M9 5v6H5V5h4m10 8v6h-4v-6h4M9 17v2H5v-2h4M21 3h-8v6h8V3zM11 3H3v10h8V3zm10 8h-8v10h8V11zm-10 4H3v6h8v-6z"})),category:"shopkeeper",supports:{align:["center","wide","full"]},attributes:{categoryIDs:{type:"string",default:""},result:{type:"array",default:[]},queryCategories:{type:"string",default:""},queryCategoriesLast:{type:"string",default:""},queryDisplayType:{type:"string",default:"all_categories"},isLoading:{type:"bool",default:!1},querySearchString:{type:"string",default:""},querySearchResults:{type:"array",default:[]},querySearchNoResults:{type:"bool",default:!1},querySearchSelected:{type:"array",default:[]},parentOnly:{type:"bool",default:!1},hideEmpty:{type:"bool",default:!1},orderby:{type:"string",default:"menu_order"},productCount:{type:"bool",default:!0},limit:{type:"int",default:8},columns:{type:"int",default:3}},edit:function(n){function l(e){return"/wc/v3/products/categories"+e}function t(){var e=void 0;e="all_categories"==o.queryDisplayType?r(o.limit,o.orderby,o.parentOnly,o.hideEmpty):o.queryCategories,n.setAttributes({queryCategoriesLast:e}),n.setAttributes({doneFirstPostsLoad:!0}),""!=e&&h({path:e}).then(function(e){"menu_order"==o.orderby&&"all_categories"==o.queryDisplayType&&(e=function e(t,r){for(var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=0;i<r.length;i++)r[i].parent==t&&(r[i].level=a,s.push(r[i]),e(r[i].id,r,s,a+1));return s}(0,e)),n.setAttributes({result:e}),n.setAttributes({isLoading:!1});for(var t="",r=0;r<e.length;r++)t+=e[r].id+",";n.setAttributes({categoryIDs:t})})}function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"menu_order",r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],s=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];if("specific"===o.queryDisplayType)return o.queryCategories;var a=l("?per_page="+e);switch(t){case"menu_order":break;case"title_asc":a+="&orderby=slug&order=asc";break;case"title_desc":a+="&orderby=slug&order=desc"}return!0===r&&(a+="&parent=0"),!0===s&&(a+="&hide_empty=true"),a}var o=n.attributes;return o.selectedIDS=o.selectedIDS||[],o.doneFirstPostsLoad=o.doneFirstPostsLoad||!1,[u(y,{key:"categories-main-inspector"},u("div",{className:"main-inspector-wrapper"},u(p,{key:"query-panel-select",label:i.__("Source:","shopkeeper-extender"),value:o.queryDisplayType,options:[{label:i.__("Manually pick","shopkeeper-extender"),value:"specific"},{label:i.__("All Categories","shopkeeper-extender"),value:"all_categories"}],onChange:function(e){return n.setAttributes({queryDisplayType:e})}}),"specific"===o.queryDisplayType&&u("div",{className:"products-ajax-search-wrapper"},u(c,{key:"query-panel-string",type:"search",className:"products-ajax-search",value:o.querySearchString,placeholder:i.__("Search for categories to display","shopkeeper-extender"),onChange:function(e){if(n.setAttributes({querySearchString:e}),!(e.length<3)){var t=l("?per_page=10&search="+e);h({path:t}).then(function(e){0==e.length?n.setAttributes({querySearchNoResults:!0}):n.setAttributes({querySearchNoResults:!1}),n.setAttributes({querySearchResults:e})})}}})),"specific"===o.queryDisplayType&&""!=o.querySearchString&&u("div",{className:"products-ajax-search-results"},function(){var e=[];if(1==o.querySearchNoResults)return u("span",{className:"no-results"},i.__("No categories matching.","shopkeeper-extender"));for(var t,a=o.querySearchResults,r=0;r<a.length;r++){var s=void 0;s=null!==a[r].image&&""!=a[r].image.src?u("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+a[r].image.src+"')\"></span>"}}):u("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),e.push(u("span",{key:"item-"+a[r].id,className:(t=a[r].id,-1==o.selectedIDS.indexOf(t)?"single-result":"single-result selected"),title:a[r].name.replace(/&amp;/g,"&"),"data-index":r},s,u("label",{className:"title-wrapper"},u("input",{type:"checkbox",value:r,onChange:function(e){e.target;var t=o.selectedIDS,r=t.indexOf(a[e.target.value].id);-1==r?t.push(a[e.target.value].id):t.splice(r,1),n.setAttributes({selectedIDS:t});var s=l("?include="+t.join(",")+"&orderby=include");0<t.length?n.setAttributes({queryCategories:s}):n.setAttributes({queryCategories:""}),h({path:s}).then(function(e){n.setAttributes({querySearchSelected:e})})}}),a[r].name.replace(/&amp;/g,"&"),u("span",{className:"dashicons dashicons-yes"}),u("span",{className:"dashicons dashicons-no-alt"}))))}return e}()),"specific"===o.queryDisplayType&&0<o.querySearchSelected.length&&u("div",{className:"products-selected-results-wrapper"},u("label",{},i.__("Selected Products:","shopkeeper-extender")),u("div",{className:"products-selected-results"},function(){var e=[],a=o.querySearchSelected;if(o.selectedIDS.length<1&&0<a.length){for(var t=[],r=0;r<a.length;r++)t.push(a[r].id);n.setAttributes({selectedIDS:t})}for(var s=0;s<a.length;s++){var i="";i=null!==a[s].image&&""!=a[s].image.src?u("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+a[s].image.src+"')\"></span>"}}):u("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),e.push(u("span",{key:"item-"+a[s].id,className:"single-result",title:a[s].name.replace(/&amp;/g,"&")},i,u("label",{className:"title-wrapper"},u("input",{type:"checkbox",value:s,onChange:function(e){e.target;var t=o.selectedIDS,r=t.indexOf(a[e.target.value].id);-1!=r&&t.splice(r,1),n.setAttributes({selectedIDS:t});var s=l("?include="+t.join(",")+"&orderby=include");0<t.length?n.setAttributes({queryCategories:s}):n.setAttributes({queryCategories:""}),h({path:s}).then(function(e){n.setAttributes({querySearchSelected:e})})}}),a[s].name.replace(/&amp;/g,"&"),u("span",{className:"dashicons dashicons-no-alt"}))))}return e}())),"all_categories"===o.queryDisplayType&&[u(p,{key:"categories-grid-order-by",options:[{value:"menu_order",label:i.__("Menu Order","shopkeeper-extender")},{value:"title_asc",label:i.__("Alphabetical Ascending","shopkeeper-extender")},{value:"title_desc",label:i.__("Alphabetical Descending","shopkeeper-extender")}],label:i.__("Order By","shopkeeper-extender"),value:o.orderby,onChange:function(e){n.setAttributes({orderby:e})}}),u(c,{key:"categories-grid-display-number",label:i.__("How many product categories to display?","shopkeeper-extender"),type:"number",value:o.limit,onChange:function(e){n.setAttributes({limit:e})}}),u(d,{id:"categories-grid-display",key:"categories-grid-display",label:i.__("Parent Categories Only","shopkeeper-extender"),checked:o.parentOnly,onChange:function(e){n.setAttributes({parentOnly:e})}}),u(d,{key:"categories-grid-hide-empty",label:i.__("Hide Empty","shopkeeper-extender"),checked:o.hideEmpty,onChange:function(e){n.setAttributes({hideEmpty:e})}})],"specific"===o.queryDisplayType&&u("button",{className:"render-results components-button is-button is-default is-primary is-large "+(!0===o.isLoading?"is-busy":""),disabled:0==o.queryCategories.length||r(o.limit,o.orderby,o.parentOnly,o.hideEmpty)===o.queryCategoriesLast,onClick:function(e){n.setAttributes({isLoading:!0}),n.setAttributes({querySearchString:""}),n.setAttributes({querySearchResults:[]}),t()}},!1===o.isLoading?i.__("Update","shopkeeper-extender"):i.__("Updating","shopkeeper-extender")),u("hr",{}),u(d,{key:"categories-grid-product-count",label:i.__("Product Count","shopkeeper-extender"),checked:o.productCount,onChange:function(e){n.setAttributes({productCount:e})}}))),u(g,{key:"sk_categories-grid-render",block:"getbowtied/sk-categories-grid",attributes:{categoryIDs:o.categoryIDs,queryCategories:o.queryCategories,queryCategoriesLast:o.queryCategoriesLast,queryDisplayType:o.queryDisplayType,isLoading:o.isLoading,querySearchString:o.querySearchString,querySearchNoResults:o.querySearchNoResults,parentOnly:o.parentOnly,hideEmpty:o.hideEmpty,orderby:o.orderby,productCount:o.productCount,limit:o.limit,columns:o.columns,align:o.align}})]},save:function(){return null}})}(window.wp.blocks,window.wp.components,window.wp.editor,window.wp.i18n,window.wp.element,jQuery);