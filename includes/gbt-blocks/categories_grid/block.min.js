"use strict";!function(e,t,r,u,s){var p=s.createElement,a=e.registerBlockType,i=wp.components,c=i.TextControl,d=i.SelectControl,y=(i.RadioControl,i.ToggleControl),n=i.SVG,l=i.Path,g=wp.blockEditor.InspectorControls,h=wp.editor.ServerSideRender,m=wp.apiFetch;a("getbowtied/sk-categories-grid",{title:u.__("Product Categories - Grid","shopkeeper-extender"),icon:p(n,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},p(l,{d:"M19 5v2h-4V5h4M9 5v6H5V5h4m10 8v6h-4v-6h4M9 17v2H5v-2h4M21 3h-8v6h8V3zM11 3H3v10h8V3zm10 8h-8v10h8V11zm-10 4H3v6h8v-6z"})),category:"shopkeeper",supports:{align:["center","wide","full"]},attributes:{categoryIDs:{type:"string",default:""},result:{type:"array",default:[]},queryCategories:{type:"string",default:""},queryCategoriesLast:{type:"string",default:""},queryDisplayType:{type:"string",default:"all_categories"},isLoading:{type:"bool",default:!1},querySearchString:{type:"string",default:""},querySearchResults:{type:"array",default:[]},querySearchNoResults:{type:"bool",default:!1},querySearchSelected:{type:"array",default:[]},queryOrder:{type:"string",default:""},parentOnly:{type:"bool",default:!1},hideEmpty:{type:"bool",default:!1},orderby:{type:"string",default:"menu_order"},productCount:{type:"bool",default:!0},firstLoad:{type:"bool",default:!0},limit:{type:"int",default:8},columns:{type:"int",default:3}},edit:function(n){function i(e,t){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=0;a<t.length;a++)t[a].parent==e&&(t[a].level=s,r.push(t[a]),i(t[a].id,t,r,s+1));return r}function l(e){return"/wc/v3/products/categories"+e}function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"menu_order",r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],s=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];if("specific"===o.queryDisplayType)return o.queryCategories;var a=l("?per_page="+e);switch(t){case"menu_order":break;case"title_asc":a+="&orderby=slug&order=asc";break;case"title_desc":a+="&orderby=slug&order=desc"}return!0===r&&(a+="&parent=0"),!0===s&&(a+="&hide_empty=true"),a}var o=n.attributes;return o.selectedIDS=o.selectedIDS||[],o.doneFirstPostsLoad=o.doneFirstPostsLoad||!1,[p(g,{key:"categories-main-inspector"},p("div",{className:"main-inspector-wrapper"},p(d,{key:"query-panel-select",label:u.__("Source:","shopkeeper-extender"),value:o.queryDisplayType,options:[{label:u.__("Manually pick","shopkeeper-extender"),value:"specific"},{label:u.__("All Categories","shopkeeper-extender"),value:"all_categories"}],onChange:function(e){return n.setAttributes({queryDisplayType:e})}}),"specific"===o.queryDisplayType&&p("div",{className:"products-ajax-search-wrapper"},p(c,{key:"query-panel-string",type:"search",className:"products-ajax-search",value:o.querySearchString,placeholder:u.__("Search for categories to display","shopkeeper-extender"),onChange:function(e){if(n.setAttributes({querySearchString:e}),!(e.length<3)){var t=l("?per_page=10&search="+e);m({path:t}).then(function(e){0==e.length?n.setAttributes({querySearchNoResults:!0}):n.setAttributes({querySearchNoResults:!1}),n.setAttributes({querySearchResults:e})})}}})),"specific"===o.queryDisplayType&&""!=o.querySearchString&&p("div",{className:"products-ajax-search-results"},function(){var e=[];if(1==o.querySearchNoResults)return p("span",{className:"no-results"},u.__("No categories matching.","shopkeeper-extender"));for(var t,a=o.querySearchResults,r=0;r<a.length;r++){var s=void 0;s=null!==a[r].image&&""!=a[r].image.src?p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+a[r].image.src+"')\"></span>"}}):p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),e.push(p("span",{key:"item-"+a[r].id,className:(t=a[r].id,-1==o.selectedIDS.indexOf(t)?"single-result":"single-result selected"),title:a[r].name.replace(/&amp;/g,"&"),"data-index":r},s,p("label",{className:"title-wrapper"},p("input",{type:"checkbox",value:r,onChange:function(e){e.target;var t=o.selectedIDS,r=t.indexOf(a[e.target.value].id);-1==r?t.push(a[e.target.value].id):t.splice(r,1),n.setAttributes({selectedIDS:t});var s=l("?include="+t.join(",")+"&orderby=include");0<t.length?n.setAttributes({queryCategories:s}):n.setAttributes({queryCategories:""}),m({path:s}).then(function(e){n.setAttributes({querySearchSelected:e})})}}),a[r].name.replace(/&amp;/g,"&"),p("span",{className:"dashicons dashicons-yes"}),p("span",{className:"dashicons dashicons-no-alt"}))))}return e}()),"specific"===o.queryDisplayType&&0<o.querySearchSelected.length&&p("div",{className:"products-selected-results-wrapper"},p("label",{},u.__("Selected Products:","shopkeeper-extender")),p("div",{className:"products-selected-results"},function(){var e=[],a=o.querySearchSelected;if(o.selectedIDS.length<1&&0<a.length){for(var t=[],r=0;r<a.length;r++)t.push(a[r].id);n.setAttributes({selectedIDS:t})}for(var s=0;s<a.length;s++){var i="";i=null!==a[s].image&&""!=a[s].image.src?p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+a[s].image.src+"')\"></span>"}}):p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),e.push(p("span",{key:"item-"+a[s].id,className:"single-result",title:a[s].name.replace(/&amp;/g,"&")},i,p("label",{className:"title-wrapper"},p("input",{type:"checkbox",value:s,onChange:function(e){e.target;var t=o.selectedIDS,r=t.indexOf(a[e.target.value].id);-1!=r&&t.splice(r,1),n.setAttributes({selectedIDS:t});var s=l("?include="+t.join(",")+"&orderby=include");0<t.length?n.setAttributes({queryCategories:s}):n.setAttributes({queryCategories:""}),m({path:s}).then(function(e){n.setAttributes({querySearchSelected:e})})}}),a[s].name.replace(/&amp;/g,"&"),p("span",{className:"dashicons dashicons-no-alt"}))))}return e}())),"all_categories"===o.queryDisplayType&&[p(d,{key:"categories-grid-order-by",options:[{value:"menu_order",label:u.__("Menu Order","shopkeeper-extender")},{value:"title_asc",label:u.__("Alphabetical Ascending","shopkeeper-extender")},{value:"title_desc",label:u.__("Alphabetical Descending","shopkeeper-extender")}],label:u.__("Order By","shopkeeper-extender"),value:o.orderby,onChange:function(e){n.setAttributes({orderby:e})}}),p(c,{key:"categories-grid-display-number",label:u.__("How many product categories to display?","shopkeeper-extender"),type:"number",value:o.limit,onChange:function(e){n.setAttributes({limit:e})}}),p(y,{id:"categories-grid-display",key:"categories-grid-display",label:u.__("Parent Categories Only","shopkeeper-extender"),checked:o.parentOnly,onChange:function(e){n.setAttributes({parentOnly:e})}}),p(y,{key:"categories-grid-hide-empty",label:u.__("Hide Empty","shopkeeper-extender"),checked:o.hideEmpty,onChange:function(e){n.setAttributes({hideEmpty:e})}})],"specific"===o.queryDisplayType&&p("button",{className:"render-results components-button is-button is-default is-primary is-large "+(!0===o.isLoading?"is-busy":""),disabled:0==o.queryCategories.length||r(o.limit,o.orderby,o.parentOnly,o.hideEmpty)===o.queryCategoriesLast,onClick:function(e){var t;n.setAttributes({isLoading:!0}),n.setAttributes({querySearchString:""}),n.setAttributes({querySearchResults:[]}),t=void 0,t="all_categories"==o.queryDisplayType?r(o.limit,o.orderby,o.parentOnly,o.hideEmpty):o.queryCategories,n.setAttributes({queryCategoriesLast:t}),n.setAttributes({doneFirstPostsLoad:!0}),""!=t&&m({path:t}).then(function(e){"menu_order"==o.orderby&&"all_categories"==o.queryDisplayType&&(e=i(0,e)),n.setAttributes({result:e}),n.setAttributes({isLoading:!1});for(var t="",r=0;r<e.length;r++)t+=e[r].id+",";n.setAttributes({categoryIDs:t})})}},!1===o.isLoading?u.__("Update","shopkeeper-extender"):u.__("Updating","shopkeeper-extender")),p("hr",{}),p(y,{key:"categories-grid-product-count",label:u.__("Product Count","shopkeeper-extender"),checked:o.productCount,onChange:function(e){n.setAttributes({productCount:e})}}))),p(h,{key:"sk_categories-grid-render",block:"getbowtied/sk-categories-grid",attributes:{categoryIDs:o.categoryIDs,orderby:o.orderby,limit:o.limit,columns:o.columns,hideEmpty:o.hideEmpty,productCount:o.productCount,parentOnly:o.parentOnly,queryDisplayType:o.queryDisplayType}})]},save:function(){return null}})}(window.wp.blocks,window.wp.components,window.wp.editor,window.wp.i18n,window.wp.element,jQuery);