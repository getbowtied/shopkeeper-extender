"use strict";!function(e,t,a,s){var p=window.wp.element.createElement,r=e.blocks.registerBlockType,o=e.components,i=(o.TextControl,o.SelectControl),n=(o.RadioControl,o.ToggleControl,o.RangeControl),l=o.SVG,d=o.Path,c=e.blockEditor.InspectorControls,b=e.apiFetch;r("getbowtied/sk-posts-grid",{title:a.__("Posts Grid","shopkeeper-extender"),icon:p(l,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},p(d,{d:"M4 5v13h17V5H4zm10 2v3.5h-3V7h3zM6 7h3v3.5H6V7zm0 9v-3.5h3V16H6zm5 0v-3.5h3V16h-3zm8 0h-3v-3.5h3V16zm-3-5.5V7h3v3.5h-3z"})),category:"shopkeeper",supports:{align:["center","wide","full"]},attributes:{queryPosts:{type:"string",default:""},queryPostsLast:{type:"string",default:""},isLoading:{type:"bool",default:!1},categoriesIDs:{type:"string",default:","},categoriesSavedIDs:{type:"string",default:""},firstLoad:{type:"boolean",default:!0},number:{type:"number",default:"12"},columns:{type:"number",default:"3"},orderby:{type:"string",default:"date_desc"}},edit:function(_){function g(e,t,s){var r="/wp/v2/posts?per_page="+t;switch(","==e.substr(0,1)&&(e=e.substr(1)),","==e.substr(e.length-1)&&(e=e.substring(0,e.length-1)),","!=e&&""!=e&&(r="/wp/v2/posts?categories="+e+"&per_page="+t),s){case"date_asc":r+="&orderby=date&order=asc";break;case"date_desc":r+="&orderby=date&order=desc";break;case"title_asc":r+="&orderby=title&order=asc";break;case"title_desc":r+="&orderby=title&order=desc"}return r+="&lang="+posts_grid_vars.language}function t(){var e=u.queryPosts;_.setAttributes({queryPostsLast:e}),""!=e&&b({path:e}).then(function(e){_.setAttributes({result:e}),_.setAttributes({isLoading:!1}),_.setAttributes({doneFirstPostsLoad:!0})})}var s,r,o,u=_.attributes;return u.doneFirstLoad=u.doneFirstLoad||!1,u.categoryOptions=u.categoryOptions||[],u.doneFirstPostsLoad=u.doneFirstPostsLoad||!1,u.result=u.result||[],[p(c,{key:"sk-posts-grid-inspector"},p("div",{className:"main-inspector-wrapper"},p("label",{className:"components-base-control__label"},a.__("Categories:","shopkeeper-extender")),p("div",{className:"category-result-wrapper"},u.categoryOptions.length<1&&!1===u.doneFirstLoad&&(s=[],r=[],o=[],void b({path:"/wp/v2/categories?per_page=-1&lang="+posts_grid_vars.language}).then(function(e){for(var t=0;t<e.length;t++)s[t]={label:e[t].name.replace(/&amp;/g,"&"),value:e[t].id,parent:e[t].parent,count:e[t].count},r[t]=e[t].id.toString();o=function e(t,s){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=0;a<s.length;a++)s[a].parent==t&&(s[a].level=o,r.push(s[a]),e(s[a].value,s,r,o+1));return r}(0,s),_.setAttributes({categoryOptions:o}),function(e){var t=u.categoriesIDs,s=u.categoriesIDs;if(","==t.substr(0,1)&&(t=t.substr(1)),","==t.substr(t.length-1)&&(t=t.substring(0,t.length-1)),","!=t&&""!=t)for(var r=t.split(","),o=0;o<r.length;o++)-1==e.indexOf(r[o])&&(s=s.replace(","+r[o].toString()+",",","));u.categoriesIDs!=s&&(_.setAttributes({queryPosts:g(s,u.number,u.orderby)}),_.setAttributes({queryPostsLast:g(s,u.number,u.orderby)})),_.setAttributes({categoriesIDs:s}),_.setAttributes({categoriesSavedIDs:s})}(r),_.setAttributes({doneFirstLoad:!0})})),function e(){var t,s,r,o,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=[],l=u.categoryOptions;if(0<l.length)for(var d=0;d<l.length;d++)l[d].parent==a&&n.push(p("li",{key:"category_li__"+d,className:"level-"+l[d].level},p("label",{key:"category_label_"+d,className:(r=l[d].parent,o=l[d].value,(0==r?"parent parent-"+o:"child child-"+r)+" "+l[d].level)},p("input",{type:"checkbox",key:"category-checkbox-"+l[d].value,value:l[d].value,"data-index":d,"data-parent":l[d].parent,checked:(t=","+l[d].value+",",s=u.categoriesIDs,-1<s.indexOf(t.toString())),onChange:function(e){var t=u.categoriesIDs,s=t.indexOf(","+e.target.value+",");!0===e.target.checked?-1==s&&(t+=e.target.value+","):-1<s&&(t=t.replace(","+e.target.value+",",",")),_.setAttributes({categoriesIDs:t}),_.setAttributes({queryPosts:g(t,u.number,u.orderby)})}}),l[d].label,p("sup",{},l[d].count)),e(l[d].value,i+1)));return 0<n.length?p("ul",{className:"level-"+i},n):void 0}()),p(i,{key:"sk-posts-grid-order-by",options:[{value:"title_asc",label:a.__("Alphabetical Ascending","shopkeeper-extender")},{value:"title_desc",label:a.__("Alphabetical Descending","shopkeeper-extender")},{value:"date_asc",label:a.__("Date Ascending","shopkeeper-extender")},{value:"date_desc",label:a.__("Date Descending","shopkeeper-extender")}],label:a.__("Order By","shopkeeper-extender"),value:u.orderby,onChange:function(e){_.setAttributes({orderby:e});var t=u.categoriesIDs;_.setAttributes({queryPosts:g(t,u.number,e)})}}),p(n,{key:"sk-posts-grid-number",className:"range-wrapper",value:u.number,allowReset:!1,initialPosition:12,min:1,max:20,label:a.__("Number of Posts","shopkeeper-extender"),onChange:function(e){_.setAttributes({number:e});var t=u.categoriesIDs;_.setAttributes({queryPosts:g(t,e,u.orderby)})}}),p("button",{className:"render-results components-button is-button is-default is-primary is-large "+(!0===u.isLoading?"is-busy":""),disabled:0==u.queryPosts.length||u.queryPosts===u.queryPostsLast,onClick:function(e){_.setAttributes({isLoading:!0}),_.setAttributes({categoriesSavedIDs:u.categoriesIDs}),t()}},!1===u.isLoading?a.__("Update","shopkeeper-extender"):a.__("Updating","shopkeeper-extender")),p("hr",{}),p(n,{key:"sk-posts-grid-columns",value:u.columns,allowReset:!1,initialPosition:3,min:1,max:4,label:a.__("Columns","shopkeeper-extender"),onChange:function(e){_.setAttributes({columns:e})}}))),p("div",{key:"gbt_18_sk_posts_grid",className:"gbt_18_sk_posts_grid"},p("div",{key:"gbt_18_sk_editor_posts_grid_wrapper",className:"gbt_18_sk_editor_posts_grid_wrapper columns-"+u.columns},u.result.length<1&&!1===u.doneFirstPostsLoad&&t(),function(){!0===u.firstLoad&&b({path:"/wp/v2/posts?per_page=12&orderby=date&order=desc&lang="+posts_grid_vars.language}).then(function(e){_.setAttributes({result:e}),_.setAttributes({firstLoad:!1});var t="/wp/v2/posts?per_page=12&orderby=date&order=desc&lang="+posts_grid_vars.language;_.setAttributes({queryPosts:t}),_.setAttributes({queryPostsLast:t})});var e=u.result,t=[];if(0<e.length)for(var s=0;s<e.length;s++){var r="",o="gbt_18_sk_editor_posts_grid_noimg";e[s].fimg_url?(r=e[s].fimg_url,o="gbt_18_sk_editor_posts_grid_with_img"):(o="gbt_18_sk_editor_posts_grid_noimg",r=""),t.push(p("div",{key:"gbt_18_sk_editor_posts_grid_item_"+e[s].id,className:"gbt_18_sk_editor_posts_grid_item"},p("a",{key:"gbt_18_sk_editor_posts_grid_item_link_"+s,className:"gbt_18_sk_editor_posts_grid_item_link"},p("span",{key:"gbt_18_sk_editor_posts_grid_img_container_"+s,className:"gbt_18_sk_editor_posts_grid_img_container"},p("span",{key:"gbt_18_sk_editor_posts_grid_img_overlay_"+s,className:"gbt_18_sk_editor_posts_grid_img_overlay"}),p("span",{key:"gbt_18_sk_editor_posts_grid_img_"+s,className:"gbt_18_sk_editor_posts_grid_img "+o,style:{backgroundImage:"url("+r+")"}})),p("span",{key:"gbt_18_sk_editor_posts_grid_title_"+s,className:"gbt_18_sk_posts_grid_title",dangerouslySetInnerHTML:{__html:e[s].title.rendered}}))))}return t}()))]},save:function(e){return null}})}(window.wp,window.wp.blocks,window.wp.i18n);